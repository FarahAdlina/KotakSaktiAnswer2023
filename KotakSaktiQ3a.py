import pandas as pd
import mysql.connector as db

#Config database
db_config = {
    'host': '127.0.0.1',
    'user': 'root',
    'password': '1234',
    'database': 'bookstore'
}

#Establish a connection
connection = db.connect(**db_config)
cursor = connection.cursor()

#Generate table
cursor.execute('''
CREATE TABLE IF NOT EXISTS Customers
(
ID INT NOT NULL AUTO_INCREMENT,
NAME VARCHAR (255) NOT NULL,
EMAIL VARCHAR (255),
TEL VARCHAR (15),
CREATED_AT DATETIME NOT NULL,
UPDATED_AT DATETIME NOT NULL,

CONSTRAINT Customers_PK PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS Invoices
(
ID INT NOT NULL AUTO_INCREMENT,
NUMBER INT (8) NOT NULL,
SUB_TOTAL FLOAT NOT NULL,
TAX_TOTAL FLOAT NOT NULL,
TOTAL FLOAT NOT NULL,
CUSTOMER_ID INT NOT NULL,
CREATED_AT DATETIME NOT NULL,
UPDATED_AT DATETIME NOT NULL,

CONSTRAINT Invoice_PK PRIMARY KEY (ID),
CONSTRAINT Customers_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES Customers(ID)
);

CREATE TABLE IF NOT EXISTS Invoice_lines
(
ID INT NOT NULL AUTO_INCREMENT,
DESCRIPTION VARCHAR (255) NOT NULL,
UNIT_PRICE FLOAT NOT NULL,
QUANTITY INT (3) NOT NULL,
SUB_TOTAL FLOAT NOT NULL,
TAX_TOTAL FLOAT NOT NULL,
TOTAL FLOAT NOT NULL,
TAX_ID INT,
SKU_ID INT NOT NULL,
INVOICE_ID INT NOT NULL,

CONSTRAINT Invoice_Lines_PK PRIMARY KEY (ID),
CONSTRAINT Invoice_FK FOREIGN KEY (INVOICE_ID) REFERENCES Invoices(ID)
);
''')

#insert data
cursor.execute('''
#Data for cutomers
INSERT INTO customers (NAME, EMAIL, TEL, CREATED_AT, UPDATED_AT) 
VALUES ("Irfan Bakti", "irfan88@example.com", "+60123456789", "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO customers (NAME, EMAIL, TEL, CREATED_AT, UPDATED_AT) 
VALUES ("Jack Smmith", "jack.smmith@acme.io", "+60132456781", "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO customers (NAME, EMAIL, TEL, CREATED_AT, UPDATED_AT) 
VALUES ("Nazir", "", "+601185434012", "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO customers (NAME, EMAIL, TEL, CREATED_AT, UPDATED_AT) 
VALUES ("Faiz Ma", "faiz.ma@jholow.cn", "+6019772002", "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO customers (NAME, EMAIL, TEL, CREATED_AT, UPDATED_AT) 
VALUES ("Isham Rais", "isham@pmo.gov.my", "+60135482020", "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO customers (NAME, EMAIL, TEL, CREATED_AT, UPDATED_AT) 
VALUES ("Shanon Teoh", "shahnon.teoh@st.com.sg", "", "2019-08-07 08:13:21", "2019-08-07 08:13:21");


#Data for invoices
INSERT INTO invoices (NUMBER, SUB_TOTAL, TAX_TOTAL, TOTAL, CUSTOMER_ID, CREATED_AT, UPDATED_AT)
VALUES (20190001, 30.00, 0.00, 30.00, 1, "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO invoices (NUMBER, SUB_TOTAL, TAX_TOTAL, TOTAL, CUSTOMER_ID, CREATED_AT, UPDATED_AT)
VALUES (20190002, 150.00, 0.00, 150.00, 2, "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO invoices (NUMBER, SUB_TOTAL, TAX_TOTAL, TOTAL, CUSTOMER_ID, CREATED_AT, UPDATED_AT)
VALUES (20190003, 30.00, 0.00, 30.00, 2, "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO invoices (NUMBER, SUB_TOTAL, TAX_TOTAL, TOTAL, CUSTOMER_ID, CREATED_AT, UPDATED_AT)
VALUES (20190004, 55.00, 0.00, 55.00, 3, "2019-08-07 08:13:21", "2019-08-07 08:13:21");

INSERT INTO invoices (NUMBER, SUB_TOTAL, TAX_TOTAL, TOTAL, CUSTOMER_ID, CREATED_AT, UPDATED_AT)
VALUES (20190005, 450.00, 0.00, 450.00, 6, "2019-08-07 08:13:21", "2019-08-07 08:13:21");


#Data for invoice_lines
INSERT INTO invoice_lines (DESCRIPTION, UNIT_PRICE, QUANTITY, SUB_TOTAL, TAX_TOTAL, TOTAL, SKU_ID, INVOICE_ID)
VALUES ("Book #1", 30.00, 1, 30.00, 0.00, 30.00, 1, 1);

INSERT INTO invoice_lines (DESCRIPTION, UNIT_PRICE, QUANTITY, SUB_TOTAL, TAX_TOTAL, TOTAL, SKU_ID, INVOICE_ID)
VALUES ("Book #2", 25.00, 4, 100.00, 0.00, 100.00, 2, 2);

INSERT INTO invoice_lines (DESCRIPTION, UNIT_PRICE, QUANTITY, SUB_TOTAL, TAX_TOTAL, TOTAL, SKU_ID, INVOICE_ID)
VALUES ("Book #3", 50.00, 1, 50.00, 0.00, 50.00, 3, 2);

INSERT INTO invoice_lines (DESCRIPTION, UNIT_PRICE, QUANTITY, SUB_TOTAL, TAX_TOTAL, TOTAL, SKU_ID, INVOICE_ID)
VALUES ("Book #1", 30.00, 1, 30.00, 0.00, 30.00, 1, 3);

INSERT INTO invoice_lines (DESCRIPTION, UNIT_PRICE, QUANTITY, SUB_TOTAL, TAX_TOTAL, TOTAL, SKU_ID, INVOICE_ID)
VALUES ("Book #1", 30.00, 1, 30.00, 0.00, 30.00, 1, 4);

INSERT INTO invoice_lines (DESCRIPTION, UNIT_PRICE, QUANTITY, SUB_TOTAL, TAX_TOTAL, TOTAL, SKU_ID, INVOICE_ID)
VALUES ("Book #2", 25.00, 1, 25.00, 0.00, 25.00, 2, 4);

INSERT INTO invoice_lines (DESCRIPTION, UNIT_PRICE, QUANTITY, SUB_TOTAL, TAX_TOTAL, TOTAL, SKU_ID, INVOICE_ID)
VALUES ("Book #1", 30.00, 5, 150.00, 0.00, 150.00, 1, 5);

INSERT INTO invoice_lines (DESCRIPTION, UNIT_PRICE, QUANTITY, SUB_TOTAL, TAX_TOTAL, TOTAL, SKU_ID, INVOICE_ID)
VALUES ("Book #3", 50.00, 6, 300.00, 0.00, 300.00, 3, 5);
''')

connection.commit()
connection.close()